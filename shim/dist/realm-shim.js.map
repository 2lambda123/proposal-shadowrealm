{"version":3,"file":"realm-shim.js","sources":["../src/slots.js","../src/commons.js","../src/handler.js","../src/evaluators.js","../src/accessors.js","../src/functions.js","../src/sanitize.js","../src/sandbox.js","../src/stdlib.js","../src/intrinsics.js","../src/utils.js","../src/realm.js"],"sourcesContent":["export const RealmRecord = Symbol('Realm Slot');\nexport const Intrinsics = Symbol('Intrinsics Slot');\nexport const GlobalObject = Symbol('GlobalObject Slot');\nexport const GlobalThisValue = Symbol('GlobalThisValue Slot');\nexport const GlobalEnv = Symbol('GlobalEnv Slot');\nexport const EvalHook = Symbol('EvalHook Slot');\nexport const IsDirectEvalHook = Symbol('IsDirectEvalHook Slot');\nexport const ImportHook = Symbol('ImportHook Slot');\nexport const ImportMetaHook = Symbol('ImportMetaHook Slot');\nexport const ShimSandbox = Symbol('Sandbox');\n","// Declare shorthand functions. Sharing these declarations accross modules\n// improves both consitency and minification. Unused declarations are dropped\n// by the tree shaking process.\n\nexport const {\n  assign,\n  create,\n  defineProperties,\n  freeze,\n  getOwnPropertyDescriptors,\n  getOwnPropertyNames\n} = Object;\n\nexport const {\n  apply,\n  defineProperty,\n  deleteProperty,\n  getOwnPropertyDescriptor,\n  getPrototypeOf,\n  ownKeys,\n  setPrototypeOf\n} = Reflect;\n\nexport const objectHasOwnProperty = Object.prototype.hasOwnProperty;\n","export class Handler {\n  constructor(sandbox) {\n    const { unsafeGlobal } = sandbox;\n    this.unsafeGlobal = unsafeGlobal;\n\n    // this flag allow us to determine if the eval() call is a controlled\n    // eval done by the realm's code or if it is user-land invocation, so\n    // we can react differently.\n    this.isInternalEvaluation = false;\n  }\n\n  get(target, prop) {\n    // Special treatment for eval.\n    if (prop === 'eval') {\n      if (this.isInternalEvaluation) {\n        this.isInternalEvaluation = false;\n        return this.unsafeGlobal.eval;\n      }\n      return target.eval;\n    }\n    // Properties of global.\n    if (prop in target) {\n      return target[prop];\n    }\n    // Prevent the lookup for other properties.\n    return undefined;\n  }\n\n  has(target, prop) {\n    if (prop === 'eval') {\n      return true;\n    }\n    if (prop === 'arguments') {\n      return false;\n    }\n    if (prop in target) {\n      return true;\n    }\n    if (prop in this.unsafeGlobal) {\n      return true;\n    }\n    return false;\n  }\n}\n","// Portions adapted from V8 - Copyright 2016 the V8 project authors.\n// https://github.com/v8/v8/blob/master/src/builtins/builtins-function.cc\n\nimport { EvalHook, GlobalObject, Intrinsics, ShimSandbox } from './slots';\nimport { defineProperties } from './commons';\nimport { Handler } from './handler';\n\nexport function createEvalEvaluatorFactory(sandbox) {\n  const { unsafeFunction } = sandbox;\n\n  return unsafeFunction(`\n    with (arguments[0]) {\n      return function() {\n        'use strict';\n        return eval(arguments[0]);\n      };\n    }\n  `);\n}\n\nexport function createEvalEvaluator(realmRec) {\n  const sandbox = realmRec[ShimSandbox];\n  const globalObject = realmRec[GlobalObject];\n  const intrinsics = realmRec[Intrinsics];\n\n  // This proxy has several functions:\n  // 1. works with the sentinel to alternate between direct eval and confined eval.\n  // 2. shadows all properties of the hidden global by declaring them as undefined.\n  // 3. resolves all existing properties of the sandboxed global.\n  const handler = new Handler(sandbox);\n  const proxy = new Proxy(globalObject, handler);\n\n  const scopedEvaluator = sandbox.evalEvaluatorFactory(proxy);\n\n  function evaluator(src) {\n    handler.isInternalEvaluation = true;\n    // Ensure that \"this\" resolves to the secure global.\n    const result = scopedEvaluator.call(globalObject, src);\n    handler.isInternalEvaluation = false;\n    return result;\n  }\n\n  // Mimic the native eval() function. New properties are\n  // by default non-writable and non-configurable.\n  defineProperties(evaluator, {\n    name: {\n      value: 'eval'\n    }\n  });\n\n  // This instance is realm-specific, and therefore doesn't\n  // need to be frozen (only the objects reachable from it).\n\n  // Once created for a realm, the reference must be updated everywhere.\n  realmRec[EvalHook] = globalObject.eval = intrinsics.eval = evaluator;\n}\n\n/**\n * A safe version of the native Function which relies on\n * the safety of evalEvaluator for confinement.\n */\nexport function createFunctionEvaluator(realmRec) {\n  const { unsafeFunction } = realmRec[ShimSandbox];\n  const globalObject = realmRec[GlobalObject];\n  const intrinsics = realmRec[Intrinsics];\n\n  function evaluator(...params) {\n    const functionBody = params.pop() || '';\n    let functionParams = params.join(',');\n\n    if (functionParams.includes(')')) {\n      // If the formal parameters string include ) - an illegal\n      // character - it may make the combined function expression\n      // compile. We avoid this problem by checking for this early on.\n      throw new Error('Function arg string contains parenthesis');\n    }\n\n    if (functionParams.length > 0) {\n      // If the formal parameters include an unbalanced block comment, the\n      // function must be rejected. Since JavaScript does not allow nested\n      // comments we can include a trailing block comment to catch this.\n      functionParams += '\\n/*``*/';\n    }\n\n    const src = `(function(${functionParams}){\\n${functionBody}\\n})`;\n\n    return intrinsics.eval(src);\n  }\n\n  // Ensure that the different Function instances of the different\n  // sandboxes all answer properly when used with the instanceof\n  // operator to preserve indentity.\n  const FunctionPrototype = unsafeFunction.prototype;\n\n  // Mimic the native signature. New properties are\n  // by default non-writable and non-configurable.\n  defineProperties(evaluator, {\n    name: {\n      value: 'Function'\n    },\n    prototype: {\n      value: FunctionPrototype\n    }\n  });\n\n  // This instance is namespace-specific, and therefore doesn't\n  // need to be frozen (only the objects reachable from it).\n\n  // Once created for a realm, the reference must be everywhere.\n  globalObject.Function = intrinsics.Function = evaluator;\n}\n","// Adapted from SES/Caja - Copyright (C) 2011 Google Inc.\n// https://github.com/google/caja/blob/master/src/com/google/caja/ses/startSES.js\n// https://github.com/google/caja/blob/master/src/com/google/caja/ses/repairES5.js\n\nimport {\n  getPrototypeOf,\n  defineProperty,\n  defineProperties,\n  getOwnPropertyDescriptor\n} from './commons';\n\n/**\n * Replace the legacy accessors of Object to comply with strict mode\n * and ES2016 semantics, we do this by redefining them while in 'use strict'\n * https://tc39.github.io/ecma262/#sec-object.prototype.__defineGetter__\n */\nexport function repairAccessors(sandbox) {\n  const { unsafeGlobal: g } = sandbox;\n\n  defineProperties(g.Object.prototype, {\n    __defineGetter__: {\n      value(prop, func) {\n        return defineProperty(this, prop, {\n          get: func,\n          enumerable: true,\n          configurable: true\n        });\n      }\n    },\n    __defineSetter__: {\n      value(prop, func) {\n        return defineProperty(this, prop, {\n          set: func,\n          enumerable: true,\n          configurable: true\n        });\n      }\n    },\n    __lookupGetter__: {\n      value(prop) {\n        let base = this;\n        let desc;\n        while (base && !(desc = getOwnPropertyDescriptor(base, prop))) {\n          base = getPrototypeOf(base);\n        }\n        return desc && desc.get;\n      }\n    },\n    __lookupSetter__: {\n      value(prop) {\n        let base = this;\n        let desc;\n        while (base && !(desc = getOwnPropertyDescriptor(base, prop))) {\n          base = getPrototypeOf(base);\n        }\n        return desc && desc.set;\n      }\n    }\n  });\n}\n","// Adapted from SES/Caja\n// Copyright (C) 2011 Google Inc.\n// https://github.com/google/caja/blob/master/src/com/google/caja/ses/startSES.js\n// https://github.com/google/caja/blob/master/src/com/google/caja/ses/repairES5.js\n\nimport { defineProperty, defineProperties, getPrototypeOf, setPrototypeOf } from './commons';\n\n/**\n * The process to repair constructors:\n * 1. Obtain the prototype from an instance\n * 2. Create a substitute noop constructor\n * 3. Replace its prototype property with the original prototype\n * 4. Replace its prototype property's constructor with itself\n * 5. Replace its [[Prototype]] slot with the noop constructor of Function\n */\nfunction repairFunction(sandbox, functionName, functionDecl) {\n  const { unsafeEval, unsafeFunction } = sandbox;\n\n  const FunctionInstance = unsafeEval(`(${functionDecl}(){})`);\n  const FunctionPrototype = getPrototypeOf(FunctionInstance);\n\n  // Block evaluation of source when calling constructor on the prototype of functions.\n  const TamedFunction = unsafeFunction('throw new Error();');\n\n  defineProperties(TamedFunction, {\n    name: {\n      value: functionName\n    },\n    prototype: {\n      value: FunctionPrototype\n    }\n  });\n  defineProperty(FunctionPrototype, 'constructor', { value: TamedFunction });\n\n  // Prevent loop in case of Function.\n  if (functionName !== 'Function') {\n    setPrototypeOf(TamedFunction, unsafeFunction.prototype.constructor);\n  }\n}\n\n/**\n * This block replaces the original Function constructor, and the original\n * %GeneratorFunction% %AsyncFunction% and %AsyncGeneratorFunction%, with\n * safe replacements that preserve SES confinement. After this block is done,\n * the originals should no longer be reachable.\n */\nexport function repairFunctions(sandbox) {\n  const { unsafeGlobal: g } = sandbox;\n  const hasAsyncIteration = typeof g.Symbol.asyncIterator !== 'undefined';\n\n  // Here, the order of operation is important: Function needs to be\n  // repaired first since the other constructors need it.\n  repairFunction(sandbox, 'Function', 'function');\n  repairFunction(sandbox, 'GeneratorFunction', 'function*');\n  repairFunction(sandbox, 'AsyncFunction', 'async function');\n  if (hasAsyncIteration) {\n    repairFunction(sandbox, 'AsyncGeneratorFunction', 'async function*');\n  }\n}\n","import { repairAccessors } from './accessors';\nimport { repairFunctions } from './functions';\n\n// Sanitizing ensures that neither the legacy\n// accessors nor the function constructors can be\n// used to escape the confinement of the evaluators\n// to execute in the sandbox.\n\nexport function sanitize(sandbox) {\n  repairAccessors(sandbox);\n  repairFunctions(sandbox);\n}\n","import { createEvalEvaluatorFactory } from './evaluators';\nimport { sanitize } from './sanitize';\n\n// The sandbox is shim-specific. It acts as the mechanism\n// to obtain a fresh set of intrinsics together with their\n// associated eval and Function evaluators. This association\n// must be respected since the evaluators are imposing a\n// set of intrinsics, aka the \"undeniables\".\n\nfunction createContext() {\n  const iframe = document.createElement('iframe');\n\n  iframe.title = 'script';\n  iframe.style.display = 'none';\n  iframe.setAttribute('aria-hidden', true);\n\n  document.body.appendChild(iframe);\n\n  return iframe.contentWindow;\n}\n\nexport function createSandbox(context) {\n  if (context === undefined) {\n    context = createContext();\n  }\n  // The sandbox is entirely defined by these three objects.\n  // Reusing the terminology from SES/Caja.\n  const sandbox = {\n    unsafeGlobal: context,\n    unsafeEval: context.eval,\n    unsafeFunction: context.Function\n  };\n  if (sandbox.evalEvaluatorFactory === undefined) {\n    sandbox.evalEvaluatorFactory = createEvalEvaluatorFactory(sandbox);\n  }\n  sanitize(sandbox);\n  return sandbox;\n}\n","export function getStdLib(intrinsics) {\n  const i = intrinsics;\n\n  return {\n    // *** 18.1 Value Properties of the Global Object\n\n    Infinity: { value: Infinity },\n    NaN: { value: NaN },\n    undefined: { value: undefined },\n\n    // *** 18.2 Function Properties of the Global Object\n\n    eval: { value: i.eval },\n    isFinite: { value: i.isFinite },\n    isNaN: { value: i.isNaN },\n    parseFloat: { value: i.parseFloat },\n    parseInt: { value: i.parseInt },\n\n    decodeURI: { value: i.decodeURI },\n    decodeURIComponent: { value: i.decodeURIComponent },\n    encodeURI: { value: i.encodeURI },\n    encodeURIComponent: { value: i.encodeURIComponent },\n\n    // *** 18.3 Constructor Properties of the Global Object\n\n    Array: { value: i.Array },\n    ArrayBuffer: { value: i.ArrayBuffer },\n    Boolean: { value: i.Boolean },\n    DataView: { value: i.DataView },\n    Date: { value: i.Date },\n    Error: { value: i.Error },\n    EvalError: { value: i.EvalError },\n    Float32Array: { value: i.Float32Array },\n    Float64Array: { value: i.Float64Array },\n    Function: { value: i.Function },\n    Int8Array: { value: i.Int8Array },\n    Int16Array: { value: i.Int16Array },\n    Int32Array: { value: i.Int32Array },\n    Map: { value: i.Map },\n    Number: { value: i.Number },\n    Object: { value: i.Object },\n    Promise: { value: i.Promise },\n    Proxy: { value: i.Proxy },\n    RangeError: { value: i.RangeError },\n    ReferenceError: { value: i.ReferenceError },\n    RegExp: { value: i.RegExp },\n    Set: { value: i.Set },\n    // SharedArrayBuffer - Deprecated on Jan 5, 2018\n    String: { value: i.String },\n    Symbol: { value: i.Symbol },\n    SyntaxError: { value: i.SyntaxError },\n    TypeError: { value: i.TypeError },\n    Uint8Array: { value: i.Uint8Array },\n    Uint8ClampedArray: { value: i.Uint8ClampedArray },\n    Uint16Array: { value: i.Uint16Array },\n    Uint32Array: { value: i.Uint32Array },\n    URIError: { value: i.URIError },\n    WeakMap: { value: i.WeakMap },\n    WeakSet: { value: i.WeakSet },\n\n    // *** 18.4 Other Properties of the Global Object\n\n    Atomics: { value: i.Atomics },\n    JSON: { value: i.JSON },\n    Math: { value: i.Math },\n    Reflect: { value: i.Reflect },\n\n    // *** Annex B\n\n    escape: { value: i.escape },\n    unescape: { value: i.unescape },\n\n    // *** ECMA-402\n\n    Intl: { value: i.Intl },\n\n    // *** ESNext\n\n    Realm: { value: i.Realm }\n  };\n}\n","import Realm from './realm';\nimport { getPrototypeOf } from './commons';\n\n/**\n * Get the intrinsics from Table 7 & Annex B\n * Named intrinsics: available as data properties of the global object.\n * Anonymous intrinsics: not otherwise reachable by own property name traversal.\n *\n * https://tc39.github.io/ecma262/#table-7\n * https://tc39.github.io/ecma262/#table-73\n */\nexport function getIntrinsics(global) {\n  const g = global;\n\n  // Anonymous intrinsics.\n\n  const SymbolIterator = g.Symbol.iterator;\n\n  const ArrayIteratorInstance = new g.Array()[SymbolIterator]();\n  const ArrayIteratorPrototype = getPrototypeOf(ArrayIteratorInstance);\n  const IteratorPrototype = getPrototypeOf(ArrayIteratorPrototype);\n\n  const AsyncFunctionInstance = g.eval('(async function(){})');\n  const AsyncFunction = AsyncFunctionInstance.constructor;\n  const AsyncFunctionPrototype = AsyncFunction.prototype;\n\n  const GeneratorFunctionInstance = g.eval('(function*(){})');\n  const GeneratorFunction = GeneratorFunctionInstance.constructor;\n  const Generator = GeneratorFunction.prototype;\n  const GeneratorPrototype = Generator.prototype;\n\n  const hasAsyncIterator = typeof g.Symbol.asyncIterator !== 'undefined';\n\n  const AsyncGeneratorFunctionInstance = hasAsyncIterator && g.eval('(async function*(){})');\n  const AsyncGeneratorFunction = hasAsyncIterator && AsyncGeneratorFunctionInstance.constructor;\n  const AsyncGenerator = hasAsyncIterator && AsyncGeneratorFunction.prototype;\n  const AsyncGeneratorPrototype = hasAsyncIterator && AsyncGenerator.prototype;\n\n  const AsyncIteratorPrototype = hasAsyncIterator && getPrototypeOf(AsyncGeneratorPrototype);\n  const AsyncFromSyncIteratorPrototype = undefined; // Not reacheable.\n\n  const MapIteratorObject = new g.Map()[SymbolIterator]();\n  const MapIteratorPrototype = getPrototypeOf(MapIteratorObject);\n\n  const SetIteratorObject = new g.Set()[SymbolIterator]();\n  const SetIteratorPrototype = getPrototypeOf(SetIteratorObject);\n\n  const StringIteratorObject = new g.String()[SymbolIterator]();\n  const StringIteratorPrototype = getPrototypeOf(StringIteratorObject);\n\n  const ThrowTypeError = g.eval(\n    '(function () { \"use strict\"; return Object.getOwnPropertyDescriptor(arguments, \"callee\").get; })()'\n  );\n\n  const TypedArray = getPrototypeOf(g.Int8Array);\n  const TypedArrayPrototype = TypedArray.prototype;\n\n  // Named intrinsics\n\n  const intrinsics = {\n    // *** Table 7\n\n    // %Array%\n    Array: g.Array,\n    // %ArrayBuffer%\n    ArrayBuffer: g.ArrayBuffer,\n    // %ArrayBufferPrototype%\n    ArrayBufferPrototype: g.ArrayBuffer.prototype,\n    // %ArrayIteratorPrototype%\n    ArrayIteratorPrototype,\n    // %ArrayPrototype%\n    ArrayPrototype: g.Array.prototype,\n    // %ArrayProto_entries%\n    ArrayProto_entries: g.Array.prototype.entries,\n    // %ArrayProto_foreach%\n    ArrayProto_foreach: g.Array.prototype.forEach,\n    // %ArrayProto_keys%\n    ArrayProto_keys: g.Array.prototype.forEach,\n    // %ArrayProto_values%\n    ArrayProto_values: g.Array.prototype.values,\n    // %AsyncFromSyncIteratorPrototype%\n    AsyncFromSyncIteratorPrototype,\n    // %AsyncFunction%\n    AsyncFunction,\n    // %AsyncFunctionPrototype%\n    AsyncFunctionPrototype,\n    // %AsyncGenerator%\n    AsyncGenerator,\n    // %AsyncGeneratorFunction%\n    AsyncGeneratorFunction,\n    // %AsyncGeneratorPrototype%\n    AsyncGeneratorPrototype,\n    // %AsyncIteratorPrototype%\n    AsyncIteratorPrototype,\n    // %Atomics%\n    Atomics: g.Atomics,\n    // %Boolean%\n    Boolean: g.Boolean,\n    // %BooleanPrototype%\n    BooleanPrototype: g.Boolean.prototype,\n    // %DataView%\n    DataView: g.DataView,\n    // %DataViewPrototype%\n    DataViewPrototype: g.DataView.prototype,\n    // %Date%\n    Date: g.Date,\n    // %DatePrototype%\n    DatePrototype: g.Date.prototype,\n    // %decodeURI%\n    decodeURI: g.decodeURI,\n    // %decodeURIComponent%\n    decodeURIComponent: g.decodeURIComponent,\n    // %encodeURI%\n    encodeURI: g.encodeURI,\n    // %encodeURIComponent%\n    encodeURIComponent: g.encodeURIComponent,\n    // %Error%\n    Error: g.Error,\n    // %ErrorPrototype%\n    ErrorPrototype: g.Error.prototype,\n    // %eval%\n    eval: g.eval,\n    // %EvalError%\n    EvalError: g.EvalError,\n    // %EvalErrorPrototype%\n    EvalErrorPrototype: g.EvalError.prototype,\n    // %Float32Array%\n    Float32Array: g.Float32Array,\n    // %Float32ArrayPrototype%\n    Float32ArrayPrototype: g.Float32Array.prototype,\n    // %Float64Array%\n    Float64Array: g.Float64Array,\n    // %Float64ArrayPrototype%\n    Float64ArrayPrototype: g.Float64Array.prototype,\n    // %Function%\n    Function: g.Function,\n    // %FunctionPrototype%\n    FunctionPrototype: g.Function.prototype,\n    // %Generator%\n    Generator,\n    // %GeneratorFunction%\n    GeneratorFunction,\n    // %GeneratorPrototype%\n    GeneratorPrototype,\n    // %Int8Array%\n    Int8Array: g.Int8Array,\n    // %Int8ArrayPrototype%\n    Int8ArrayPrototype: g.Int8Array.prototype,\n    // %Int16Array%\n    Int16Array: g.Int16Array,\n    // %Int16ArrayPrototype%,\n    Int16ArrayPrototype: g.Int16Array.prototype,\n    // %Int32Array%\n    Int32Array: g.Int32Array,\n    // %Int32ArrayPrototype%\n    Int32ArrayPrototype: g.Int32Array.prototype,\n    // %isFinite%\n    isFinite: g.isFinite,\n    // %isNaN%\n    isNaN: g.isNaN,\n    // %IteratorPrototype%\n    IteratorPrototype,\n    // %JSON%\n    JSON: g.JSON,\n    // %JSONParse%\n    JSONParse: g.JSON.parse,\n    // %Map%\n    Map: g.Map,\n    // %MapIteratorPrototype%\n    MapIteratorPrototype,\n    // %MapPrototype%\n    MapPrototype: g.Map.prototype,\n    // %Math%\n    Math: g.Math,\n    // %Number%\n    Number: g.Number,\n    // %NumberPrototype%\n    NumberPrototype: g.Number.prototype,\n    // %Object%\n    Object: g.Object,\n    // %ObjectPrototype%\n    ObjectPrototype: g.Object.prototype,\n    // %ObjProto_toString%\n    ObjProto_toString: g.Object.prototype.toString,\n    // %ObjProto_valueOf%\n    ObjProto_valueOf: g.Object.prototype.valueOf,\n    // %parseFloat%\n    parseFloat: g.parseFloat,\n    // %parseInt%\n    parseInt: g.parseInt,\n    // %Promise%\n    Promise: g.Promise,\n    // %Promise_all%\n    Promise_all: g.Promise.all,\n    // %Promise_reject%\n    Promise_reject: g.Promise.reject,\n    // %Promise_resolve%\n    Promise_resolve: g.Promise.resolve,\n    // %PromiseProto_then%\n    PromiseProto_then: g.Promise.prototype.then,\n    // %PromisePrototype%\n    PromisePrototype: g.Promise.prototype,\n    // %Proxy%\n    Proxy: g.Proxy,\n    // %RangeError%\n    RangeError: g.RangeError,\n    // %RangeErrorPrototype%\n    RangeErrorPrototype: g.RangeError.prototype,\n    // %ReferenceError%\n    ReferenceError: g.ReferenceError,\n    // %ReferenceErrorPrototype%\n    ReferenceErrorPrototype: g.ReferenceError.prototype,\n    // %Reflect%\n    Reflect: g.Reflect,\n    // %RegExp%\n    RegExp: g.RegExp,\n    // %RegExpPrototype%\n    RegExpPrototype: g.RegExp.prototype,\n    // %Set%\n    Set: g.Set,\n    // %SetIteratorPrototype%\n    SetIteratorPrototype,\n    // %SetPrototype%\n    SetPrototype: g.Set.prototype,\n    // %SharedArrayBuffer%\n    // SharedArrayBuffer - Deprecated on Jan 5, 2018\n    // %SharedArrayBufferPrototype%\n    // SharedArrayBufferPrototype - Deprecated on Jan 5, 2018\n    // %String%\n    String: g.String,\n    // %StringIteratorPrototype%\n    StringIteratorPrototype,\n    // %StringPrototype%\n    StringPrototype: g.String.prototype,\n    // %Symbol%\n    Symbol: g.Symbol,\n    // %SymbolPrototype%\n    SymbolPrototype: g.Symbol.prototype,\n    // %SyntaxError%\n    SyntaxError: g.SyntaxError,\n    // %SyntaxErrorPrototype%\n    SyntaxErrorPrototype: g.SyntaxError.prototype,\n    // %ThrowTypeError%\n    ThrowTypeError,\n    // %TypedArray%\n    TypedArray,\n    // %TypedArrayPrototype%\n    TypedArrayPrototype,\n    // %TypeError%\n    TypeError: g.TypeError,\n    // %TypeErrorPrototype%\n    TypeErrorPrototype: g.TypeError.prototype,\n    // %Uint8Array%\n    Uint8Array: g.Uint8Array,\n    // %Uint8ArrayPrototype%\n    Uint8ArrayPrototype: g.Uint8Array.prototype,\n    // %Uint8ClampedArray%\n    Uint8ClampedArray: g.Uint8ClampedArray,\n    // %Uint8ClampedArrayPrototype%\n    Uint8ClampedArrayPrototype: g.Uint8ClampedArray.prototype,\n    // %Uint16Array%\n    Uint16Array: g.Uint16Array,\n    // %Uint16ArrayPrototype%\n    Uint16ArrayPrototype: g.Uint16Array.prototype,\n    // %Uint32Array%\n    Uint32Array: g.Uint32Array,\n    // %Uint32ArrayPrototype%\n    Uint32ArrayPrototype: g.Uint32Array.prototype,\n    // %URIError%\n    URIError: g.URIError,\n    // %URIErrorPrototype%\n    URIErrorPrototype: g.URIError.prototype,\n    // %WeakMap%\n    WeakMap: g.WeakMap,\n    // %WeakMapPrototype%\n    WeakMapPrototype: g.WeakMap.prototype,\n    // %WeakSet%\n    WeakSet: g.WeakSet,\n    // %WeakSetPrototype%\n    WeakSetPrototype: g.WeakSet.prototype,\n\n    // *** Annex B\n\n    // %escape%\n    escape: g.escape,\n    // %unescape%\n    unescape: g.unescape,\n\n    // *** ECMA-402\n\n    Intl: g.Intl,\n\n    // *** ESNext\n\n    Realm // intentionally passing around the Realm Constructor, which could be used as a side channel, but still!\n  };\n\n  return intrinsics;\n}\n","export function assert(condition) {\n  if (!condition) {\n    throw new Error();\n  }\n}\n\nexport function IsCallable(obj) {\n  return typeof obj === 'function';\n}\n","import { createSandbox } from './sandbox';\nimport { createEvalEvaluator, createFunctionEvaluator } from './evaluators';\nimport { getStdLib } from './stdlib';\nimport { getIntrinsics } from './intrinsics';\nimport { assert, IsCallable } from './utils';\nimport { assign, create, defineProperties } from './commons';\n\nimport {\n  RealmRecord,\n  Intrinsics,\n  GlobalObject,\n  GlobalThisValue,\n  GlobalEnv,\n  EvalHook,\n  IsDirectEvalHook,\n  ImportHook,\n  ImportMetaHook,\n  ShimSandbox\n} from './slots';\n\n// shim specific\nfunction getSandbox(realmRec) {\n  const sandbox = realmRec[ShimSandbox];\n  assert(typeof sandbox === 'object');\n  return sandbox;\n}\n\n// shim specific\nfunction getExecutionContext() {\n  // eslint-disable-next-line no-new-func\n  return new Function('return this')();\n}\n\n// shim specific\nfunction getCurrentRealmRecord() {\n  const context = getExecutionContext();\n  let realmRec = context[RealmRecord];\n  if (realmRec === undefined) {\n    // If there is no realm slot, then we are outside of a realm shim,\n    // and we emulate what the current realm record should be. This is\n    // a root realm and we define all fields based on the context.\n    const sandbox = createSandbox(context);\n    realmRec = {\n      [Intrinsics]: getIntrinsics(sandbox.unsafeGlobal),\n      [GlobalObject]: sandbox.unsafeGlobal,\n      [EvalHook]: sandbox.unsafeEval,\n      [ShimSandbox]: sandbox\n    };\n    // Setup the RealmRecord for the next execution.\n    context[RealmRecord] = realmRec;\n  }\n  return realmRec;\n}\n\n// <!-- es6num=\"8.1.2.5\" -->\nfunction NewGlobalEnvironment(G, thisValue) {\n  // diverging from spec to accomodate the iframe as the lexical environment\n  // using a class for better debugability\n  class EnvironmentRecord {\n    constructor(/*globalObject*/) {\n      this[GlobalThisValue] = thisValue;\n    }\n  }\n  return new EnvironmentRecord(G);\n}\n\n// <!-- es6num=\"8.2.3\" -->\nfunction SetRealmGlobalObject(realmRec, globalObj, thisValue) {\n  if (globalObj === undefined) {\n    const intrinsics = realmRec[Intrinsics];\n    globalObj = create(intrinsics.ObjectPrototype);\n  }\n  assert(typeof globalObj === 'object');\n  if (thisValue === undefined) thisValue = globalObj;\n  realmRec[GlobalObject] = globalObj;\n  const newGlobalEnv = NewGlobalEnvironment(globalObj, thisValue);\n  realmRec[GlobalEnv] = newGlobalEnv;\n  return realmRec;\n}\n\n// <!-- es6num=\"8.2.4\" -->\nfunction SetDefaultGlobalBindings(realmRec) {\n  const global = realmRec[GlobalObject];\n  // For each property of the Global Object specified in clause 18, do\n  // ---> diverging\n  const intrinsics = realmRec[Intrinsics];\n  const descs = getStdLib(intrinsics);\n  defineProperties(global, descs);\n  // <--- diverging\n  return global;\n}\n\n// <!-- es6num=\"8.2.2\" -->\nfunction CreateIntrinsics(realmRec) {\n  // ---> diverging\n  const sandbox = getSandbox(realmRec);\n  const intrinsics = getIntrinsics(sandbox.unsafeGlobal);\n  // <--- diverging\n  realmRec[Intrinsics] = intrinsics;\n  return intrinsics;\n}\n\n// <!-- proposal=\"11.1.1\" -->\n// <!-- deprecates es6num=\"8.2.1\" -->\nfunction CreateRealmRec(intrinsics, /* shim specific */ sandbox) {\n  const realmRec = {\n    // ES specs table-21\n    [Intrinsics]: {},\n    [GlobalObject]: undefined,\n    [GlobalEnv]: undefined,\n    // [TemplateMap]: [],\n    // [HostDefined]: undefined,\n\n    // Realm specs table-2\n    [EvalHook]: undefined,\n    [IsDirectEvalHook]: undefined,\n    [ImportHook]: undefined,\n    [ImportMetaHook]: undefined,\n\n    // ---> diverging\n    [ShimSandbox]: sandbox\n    // <--- diverging\n  };\n  if (intrinsics === undefined) {\n    CreateIntrinsics(realmRec);\n  } else {\n    // 1. Assert: In this case, _intrinsics_ must be a Record with field names listed in column one of Table 7.\n    realmRec[Intrinsics] = intrinsics;\n  }\n  return realmRec;\n}\n\n// <!-- proposal=\"1.2\" -->\nfunction InvokeDirectEvalHook(realmRec, x) {\n  // 1. Assert: realm is a Realm Record.\n  const fn = realmRec[EvalHook];\n  if (fn === undefined) return x;\n  assert(IsCallable(fn) === true);\n  return fn.call(undefined, x);\n}\n\n// <!-- es6num=\"18.2.1.1\" -->\nfunction PerformEval(x, evalRealm, strictCaller, direct) {\n  assert(direct === false ? strictCaller === false : true);\n  if (typeof x !== 'string') return x;\n  // ---> diverging\n  if (direct === true) {\n    x = InvokeDirectEvalHook(x, evalRealm);\n  }\n  return evalRealm[EvalHook](x);\n}\n\n// <!-- proposal=\"11.3.1\" -->\nexport default class Realm {\n  constructor(options) {\n    const O = this;\n    const parentRealm = getCurrentRealmRecord();\n    const opts = Object(options);\n\n    let importHook = opts.importHook;\n    if (importHook === 'inherit') {\n      importHook = parentRealm[ImportHook];\n    } else if (importHook !== undefined && IsCallable(importHook) === false) {\n      throw new TypeError();\n    }\n\n    let importMetaHook = opts.importMetaHook;\n    if (importMetaHook === 'inherit') {\n      importMetaHook = parentRealm[ImportMetaHook];\n    } else if (importMetaHook !== undefined && IsCallable(importMetaHook) === false) {\n      throw new TypeError();\n    }\n\n    let evalHook = opts.evalHook;\n    if (evalHook === 'inherit') {\n      evalHook = parentRealm[EvalHook];\n    } else if (evalHook !== undefined && IsCallable(evalHook) === false) {\n      throw new TypeError();\n    }\n\n    let isDirectEvalHook = opts.isDirectEvalHook;\n    if (isDirectEvalHook === 'inherit') {\n      isDirectEvalHook = parentRealm[IsDirectEvalHook];\n    } else if (isDirectEvalHook !== undefined && IsCallable(isDirectEvalHook) === false) {\n      throw new TypeError();\n    }\n\n    // ---> diverging\n    // Limitation: intrisics and sandbox must always match. We\n    // known this early during the constuction of the realm.\n    let intrinsics = opts.intrinsics;\n    let sandbox;\n    if (intrinsics === 'inherit') {\n      // When we inherit the intrinsics, we also must\n      // inherit the sandbox.\n      intrinsics = parentRealm[Intrinsics];\n      sandbox = parentRealm[ShimSandbox];\n    } else if (intrinsics === undefined) {\n      // When intrinics are not specified, we\n      // need to create a sandbox.\n      sandbox = createSandbox();\n    } else {\n      throw new TypeError();\n    }\n    // <--- diverging\n\n    const thisValue = opts.thisValue;\n    if (thisValue !== undefined && typeof thisValue !== 'object') {\n      throw new TypeError();\n    }\n\n    const realmRec = CreateRealmRec(intrinsics, sandbox);\n    O[RealmRecord] = realmRec;\n\n    SetRealmGlobalObject(realmRec, undefined, thisValue);\n    // ---> diverging\n    // Limitation: the evaluators are tied to a global object and\n    // need to be created after the global object. It is process\n    // also updates the intrinsics.\n    createEvalEvaluator(realmRec);\n    createFunctionEvaluator(realmRec);\n    // <--- diverging\n\n    if (importHook === undefined) {\n      // new built-in function object as defined in <emu-xref href=\"#sec-realm-default-import-hook-functions\"></emu-xref>\n      importHook = function(/*referrer, specifier*/) {\n        throw new TypeError();\n      };\n    }\n    realmRec[ImportHook] = importHook;\n    if (evalHook !== undefined) {\n      realmRec[EvalHook] = evalHook;\n    }\n    if (isDirectEvalHook !== undefined) {\n      realmRec[IsDirectEvalHook] = isDirectEvalHook;\n    }\n\n    const init = O.init;\n    if (!IsCallable(init)) throw new TypeError();\n    init.call(O);\n  }\n\n  init() {\n    const O = this;\n    if (typeof O !== 'object') throw new TypeError();\n    if (!(RealmRecord in O)) throw new TypeError();\n    SetDefaultGlobalBindings(O[RealmRecord]);\n  }\n\n  eval(x) {\n    const O = this;\n    if (typeof O !== 'object') throw new TypeError();\n    if (!(RealmRecord in O)) throw new TypeError();\n    const evalRealm = O[RealmRecord];\n    // HostEnsureCanCompileStrings(the current Realm Record, _evalRealm_).\n    return PerformEval(x, evalRealm, false, false);\n  }\n\n  get stdlib() {\n    const O = this;\n    if (typeof O !== 'object') throw new TypeError();\n    if (!(RealmRecord in O)) throw new TypeError();\n    // TODO: align with spec\n    const intrinsics = O[RealmRecord][Intrinsics];\n    return getStdLib(intrinsics);\n  }\n\n  get intrinsics() {\n    const O = this;\n    if (typeof O !== 'object') throw new TypeError();\n    if (!(RealmRecord in O)) throw new TypeError();\n    // TODO: align with spec\n    const intrinsics = O[RealmRecord][Intrinsics];\n    return assign({}, intrinsics);\n  }\n\n  get global() {\n    const O = this;\n    if (typeof O !== 'object') throw new TypeError();\n    if (!(RealmRecord in O)) throw new TypeError();\n    return O[RealmRecord][GlobalObject];\n  }\n\n  get thisValue() {\n    const O = this;\n    if (typeof O !== 'object') throw new TypeError();\n    if (!(RealmRecord in O)) throw new TypeError();\n    const envRec = O[RealmRecord][GlobalEnv];\n    return envRec[GlobalThisValue];\n  }\n}\n\nRealm.toString = () => 'function Realm() { [shim code] }';\n"],"names":[],"mappings":"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"}