(function(a,b){'object'==typeof exports&&'undefined'!=typeof module?module.exports=b():'function'==typeof define&&define.amd?define(b):a.RealmShim=b()})(this,function(){'use strict';function a(a){const{unsafeFunction:b}=a;return b(`
    with (arguments[0]) {
      return function() {
        'use strict';
        return eval(arguments[0]);
      };
    }
  `)}function b(a){function b(a){f.isInternalEvaluation=!0;const b=h.call(d,a);return f.isInternalEvaluation=!1,b}const c=a[G],d=a[z],e=a[x],f=new U(c),g=new Proxy(d,f),h=c.evalEvaluatorFactory(g);J(b,{name:{value:'eval'}}),a[C]=d.eval=e.eval=b}function c(a){function b(...a){const b=a.pop()||'';let c=a.join(',');if(c.includes(')'))throw new Error('Function arg string contains parenthesis');0<c.length&&(c+='\n/*``*/');const d=`(function(${c}){\n${b}\n})`;return e.eval(d)}const{unsafeFunction:c}=a[G],d=a[z],e=a[x],f=c.prototype;J(b,{name:{value:'Function'},prototype:{value:f}}),d.Function=e.Function=b}function d(a){const{unsafeGlobal:b}=a;J(b.Object.prototype,{__defineGetter__:{value(a,b){return O(this,a,{get:b,enumerable:!0,configurable:!0})}},__defineSetter__:{value(a,b){return O(this,a,{set:b,enumerable:!0,configurable:!0})}},__lookupGetter__:{value(a){let b,c=this;for(;c&&!(b=Q(c,a));)c=R(c);return b&&b.get}},__lookupSetter__:{value(a){let b,c=this;for(;c&&!(b=Q(c,a));)c=R(c);return b&&b.set}}})}function e(a,b,c){const{unsafeEval:d,unsafeFunction:e}=a,f=d(`(${c}(){})`),g=R(f),h=e('throw new Error();');J(h,{name:{value:b},prototype:{value:g}}),O(g,'constructor',{value:h}),'Function'!==b&&T(h,e.prototype.constructor)}function f(a){const{unsafeGlobal:b}=a,c='undefined'!=typeof b.Symbol.asyncIterator;e(a,'Function','function'),e(a,'GeneratorFunction','function*'),e(a,'AsyncFunction','async function'),c&&e(a,'AsyncGeneratorFunction','async function*')}function g(a){d(a),f(a)}function h(){const a=document.createElement('iframe');return a.title='script',a.style.display='none',a.setAttribute('aria-hidden',!0),document.body.appendChild(a),a.contentWindow}function i(b){void 0===b&&(b=h());const c={unsafeGlobal:b,unsafeEval:b.eval,unsafeFunction:b.Function};return void 0===c.evalEvaluatorFactory&&(c.evalEvaluatorFactory=a(c)),g(c),c}function j(a){const b=a;return{Infinity:{value:Infinity},NaN:{value:NaN},undefined:{value:void 0},eval:{value:b.eval},isFinite:{value:b.isFinite},isNaN:{value:b.isNaN},parseFloat:{value:b.parseFloat},parseInt:{value:b.parseInt},decodeURI:{value:b.decodeURI},decodeURIComponent:{value:b.decodeURIComponent},encodeURI:{value:b.encodeURI},encodeURIComponent:{value:b.encodeURIComponent},Array:{value:b.Array},ArrayBuffer:{value:b.ArrayBuffer},Boolean:{value:b.Boolean},DataView:{value:b.DataView},Date:{value:b.Date},Error:{value:b.Error},EvalError:{value:b.EvalError},Float32Array:{value:b.Float32Array},Float64Array:{value:b.Float64Array},Function:{value:b.Function},Int8Array:{value:b.Int8Array},Int16Array:{value:b.Int16Array},Int32Array:{value:b.Int32Array},Map:{value:b.Map},Number:{value:b.Number},Object:{value:b.Object},Promise:{value:b.Promise},Proxy:{value:b.Proxy},RangeError:{value:b.RangeError},ReferenceError:{value:b.ReferenceError},RegExp:{value:b.RegExp},Set:{value:b.Set},String:{value:b.String},Symbol:{value:b.Symbol},SyntaxError:{value:b.SyntaxError},TypeError:{value:b.TypeError},Uint8Array:{value:b.Uint8Array},Uint8ClampedArray:{value:b.Uint8ClampedArray},Uint16Array:{value:b.Uint16Array},Uint32Array:{value:b.Uint32Array},URIError:{value:b.URIError},WeakMap:{value:b.WeakMap},WeakSet:{value:b.WeakSet},Atomics:{value:b.Atomics},JSON:{value:b.JSON},Math:{value:b.Math},Reflect:{value:b.Reflect},escape:{value:b.escape},unescape:{value:b.unescape},Intl:{value:b.Intl},Realm:{value:b.Realm}}}function k(a){const b=a,c=b.Symbol.iterator,d=new b.Array()[c](),e=R(d),f=R(e),g=b.eval('(async function(){})'),h=g.constructor,i=h.prototype,j=b.eval('(function*(){})'),k=j.constructor,l=k.prototype,m=l.prototype,n='undefined'!=typeof b.Symbol.asyncIterator,o=n&&b.eval('(async function*(){})'),p=n&&o.constructor,q=n&&p.prototype,r=n&&q.prototype,s=n&&R(r),t=new b.Map()[c](),u=R(t),v=new b.Set()[c](),w=R(v),x=new b.String()[c](),y=R(x),z=b.eval('(function () { "use strict"; return Object.getOwnPropertyDescriptor(arguments, "callee").get; })()'),A=R(b.Int8Array),B=A.prototype,C={Array:b.Array,ArrayBuffer:b.ArrayBuffer,ArrayBufferPrototype:b.ArrayBuffer.prototype,ArrayIteratorPrototype:e,ArrayPrototype:b.Array.prototype,ArrayProto_entries:b.Array.prototype.entries,ArrayProto_foreach:b.Array.prototype.forEach,ArrayProto_keys:b.Array.prototype.forEach,ArrayProto_values:b.Array.prototype.values,AsyncFromSyncIteratorPrototype:void 0,AsyncFunction:h,AsyncFunctionPrototype:i,AsyncGenerator:q,AsyncGeneratorFunction:p,AsyncGeneratorPrototype:r,AsyncIteratorPrototype:s,Atomics:b.Atomics,Boolean:b.Boolean,BooleanPrototype:b.Boolean.prototype,DataView:b.DataView,DataViewPrototype:b.DataView.prototype,Date:b.Date,DatePrototype:b.Date.prototype,decodeURI:b.decodeURI,decodeURIComponent:b.decodeURIComponent,encodeURI:b.encodeURI,encodeURIComponent:b.encodeURIComponent,Error:b.Error,ErrorPrototype:b.Error.prototype,eval:b.eval,EvalError:b.EvalError,EvalErrorPrototype:b.EvalError.prototype,Float32Array:b.Float32Array,Float32ArrayPrototype:b.Float32Array.prototype,Float64Array:b.Float64Array,Float64ArrayPrototype:b.Float64Array.prototype,Function:b.Function,FunctionPrototype:b.Function.prototype,Generator:l,GeneratorFunction:k,GeneratorPrototype:m,Int8Array:b.Int8Array,Int8ArrayPrototype:b.Int8Array.prototype,Int16Array:b.Int16Array,Int16ArrayPrototype:b.Int16Array.prototype,Int32Array:b.Int32Array,Int32ArrayPrototype:b.Int32Array.prototype,isFinite:b.isFinite,isNaN:b.isNaN,IteratorPrototype:f,JSON:b.JSON,JSONParse:b.JSON.parse,Map:b.Map,MapIteratorPrototype:u,MapPrototype:b.Map.prototype,Math:b.Math,Number:b.Number,NumberPrototype:b.Number.prototype,Object:b.Object,ObjectPrototype:b.Object.prototype,ObjProto_toString:b.Object.prototype.toString,ObjProto_valueOf:b.Object.prototype.valueOf,parseFloat:b.parseFloat,parseInt:b.parseInt,Promise:b.Promise,Promise_all:b.Promise.all,Promise_reject:b.Promise.reject,Promise_resolve:b.Promise.resolve,PromiseProto_then:b.Promise.prototype.then,PromisePrototype:b.Promise.prototype,Proxy:b.Proxy,RangeError:b.RangeError,RangeErrorPrototype:b.RangeError.prototype,ReferenceError:b.ReferenceError,ReferenceErrorPrototype:b.ReferenceError.prototype,Reflect:b.Reflect,RegExp:b.RegExp,RegExpPrototype:b.RegExp.prototype,Set:b.Set,SetIteratorPrototype:w,SetPrototype:b.Set.prototype,String:b.String,StringIteratorPrototype:y,StringPrototype:b.String.prototype,Symbol:b.Symbol,SymbolPrototype:b.Symbol.prototype,SyntaxError:b.SyntaxError,SyntaxErrorPrototype:b.SyntaxError.prototype,ThrowTypeError:z,TypedArray:A,TypedArrayPrototype:B,TypeError:b.TypeError,TypeErrorPrototype:b.TypeError.prototype,Uint8Array:b.Uint8Array,Uint8ArrayPrototype:b.Uint8Array.prototype,Uint8ClampedArray:b.Uint8ClampedArray,Uint8ClampedArrayPrototype:b.Uint8ClampedArray.prototype,Uint16Array:b.Uint16Array,Uint16ArrayPrototype:b.Uint16Array.prototype,Uint32Array:b.Uint32Array,Uint32ArrayPrototype:b.Uint32Array.prototype,URIError:b.URIError,URIErrorPrototype:b.URIError.prototype,WeakMap:b.WeakMap,WeakMapPrototype:b.WeakMap.prototype,WeakSet:b.WeakSet,WeakSetPrototype:b.WeakSet.prototype,escape:b.escape,unescape:b.unescape,Intl:b.Intl,Realm:V};return C}function l(a){if(!a)throw new Error}function m(a){return'function'==typeof a}function n(a){const b=a[G];return l('object'==typeof b),b}function o(){return new Function('return this')()}function p(){const a=o();let b=a[y];if(void 0===b){const c=i(a);b={[x]:k(c.unsafeGlobal),[z]:c.unsafeGlobal,[C]:c.unsafeEval,[G]:c},a[y]=b}return b}function q(a,b){return new class{constructor(){this[A]=b}}(a)}function r(a,b,c){if(void 0===b){const c=a[x];b=I(c.ObjectPrototype)}l('object'==typeof b),void 0===c&&(c=b),a[z]=b;const d=q(b,c);return a[B]=d,a}function s(a){const b=a[z],c=a[x],d=j(c);return J(b,d),b}function t(a){const b=n(a),c=k(b.unsafeGlobal);return a[x]=c,c}function u(a,b){const c={[x]:{},[z]:void 0,[B]:void 0,[C]:void 0,[D]:void 0,[E]:void 0,[F]:void 0,[G]:b};return void 0===a?t(c):c[x]=a,c}function v(a,b){const c=a[C];return void 0===c?b:(l(!0===m(c)),c.call(void 0,b))}function w(a,b,c,d){return(l(!1!==d||!1===c),'string'!=typeof a)?a:(!0===d&&(a=v(a,b)),b[C](a))}const y=Symbol('Realm Slot'),x=Symbol('Intrinsics Slot'),z=Symbol('GlobalObject Slot'),A=Symbol('GlobalThisValue Slot'),B=Symbol('GlobalEnv Slot'),C=Symbol('EvalHook Slot'),D=Symbol('IsDirectEvalHook Slot'),E=Symbol('ImportHook Slot'),F=Symbol('ImportMetaHook Slot'),G=Symbol('Sandbox'),{assign:H,create:I,defineProperties:J,freeze:K,getOwnPropertyDescriptors:L,getOwnPropertyNames:M}=Object,{apply:N,defineProperty:O,deleteProperty:P,getOwnPropertyDescriptor:Q,getPrototypeOf:R,ownKeys:S,setPrototypeOf:T}=Reflect;class U{constructor(a){const{unsafeGlobal:b}=a;this.unsafeGlobal=b,this.isInternalEvaluation=!1}get(a,b){return'eval'===b?this.isInternalEvaluation?(this.isInternalEvaluation=!1,this.unsafeGlobal.eval):a.eval:b in a?a[b]:void 0}has(a,b){return'eval'===b||'arguments'!==b&&(!!(b in a)||!!(b in this.unsafeGlobal))}}class V{constructor(a){const d=this,e=p(),f=Object(a);let g=f.importHook;if('inherit'===g)g=e[E];else if(void 0!==g&&!1===m(g))throw new TypeError;let h=f.importMetaHook;if('inherit'===h)h=e[F];else if(void 0!==h&&!1===m(h))throw new TypeError;let j=f.evalHook;if('inherit'===j)j=e[C];else if(void 0!==j&&!1===m(j))throw new TypeError;let k=f.isDirectEvalHook;if('inherit'===k)k=e[D];else if(void 0!==k&&!1===m(k))throw new TypeError;let l,n=f.intrinsics;if('inherit'===n)n=e[x],l=e[G];else if(void 0===n)l=i();else throw new TypeError;const o=f.thisValue;if(void 0!==o&&'object'!=typeof o)throw new TypeError;const q=u(n,l);d[y]=q,r(q,void 0,o),b(q),c(q),void 0===g&&(g=function(){throw new TypeError}),q[E]=g,void 0!==j&&(q[C]=j),void 0!==k&&(q[D]=k);const s=d.init;if(!m(s))throw new TypeError;s.call(d)}init(){const a=this;if('object'!=typeof a)throw new TypeError;if(!(y in a))throw new TypeError;s(a[y])}eval(a){const b=this;if('object'!=typeof b)throw new TypeError;if(!(y in b))throw new TypeError;const c=b[y];return w(a,c,!1,!1)}get stdlib(){const a=this;if('object'!=typeof a)throw new TypeError;if(!(y in a))throw new TypeError;const b=a[y][x];return j(b)}get intrinsics(){const a=this;if('object'!=typeof a)throw new TypeError;if(!(y in a))throw new TypeError;const b=a[y][x];return H({},b)}get global(){const a=this;if('object'!=typeof a)throw new TypeError;if(!(y in a))throw new TypeError;return a[y][z]}get thisValue(){const a=this;if('object'!=typeof a)throw new TypeError;if(!(y in a))throw new TypeError;const b=a[y][B];return b[A]}}return V.toString=()=>'function Realm() { [shim code] }',V});
//# sourceMappingURL=realm-shim.min.js.map
